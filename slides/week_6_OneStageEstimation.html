<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>One-stage cluster sampling estimation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Stat 260, St. Clair" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# One-stage cluster sampling estimation
## Week 6 (5.1, 5.2.1, 5.2.3)
### Stat 260, St. Clair

---





## Design: One-Stage Cluster  Sample 

**Definition**: Divide all population **observation units** into `\(N\)` non-overlapping **clusters** of observation units.


![](cluster_pic.jpg)

.footnote[https://spot.pcc.edu/~evega/section-4.html]

---


## Design: One-Stage Cluster  Sample 


**Defined**: We take a SRS of `\(n\)` **clusters** and survey **every observation unit** in selected clusters.



![](cluster_pic.jpg)

.footnote[https://spot.pcc.edu/~evega/section-4.html]

---


## Design: Cluster vs. Stratified sampling

Take a SRS **within** each strata

![](stratified_pic.jpg)

.footnote[https://spot.pcc.edu/~evega/section-4.html]

---


## Design: One-Stage Cluster  Sample 

- **Primary Sampling Units (PSU):** clusters

--

- **Secondary Sampling Units (SSU):** observation units

  - `\(y_{ij}\)` is the measurement for unit `\(j\)` in cluster `\(i\)`
  
  - `\(M_i\)` is the number of observation units in cluster `\(i\)`
  
  - `\(M_0 = \sum_{i=1}^N M_i\)` is the total number of observation units in the population


---


## Design: One-Stage Cluster  Sample 

Why?

- Can be **cheaper** than a SRS 

- A sampling frame of clusters may exist but a sampling frame of observation units does not. 

---

## Example 1: GPA
A student wants to estimate the average GPA in his dormitory. The dorm consists of 100 suites, each with four students. He chooses a SRS of 5 of these suites and records the GPA of each student living in the suite.

---

## Example 2 - residents
Suppose you are interested in surveying the 11,482 adults who reside permanently in Northfield. You divide the town into 400 blocks and take a SRS of 5 blocks. You then visit each adult resident who lives on a selected block and record their annual income (in thousands of dollars) and whether or not they identify their political affiliation as Democratic.

---

## Inclusion probabilities: One-Stage Cluster 

What is the probability that unit `\(j\)` from cluster `\(i\)` is selected?
 

---

## Sampling weights:  One-Stage Cluster 

What is the sampling weight for  unit `\(j\)` from cluster `\(i\)` under a one-stage cluster design?

---

## Estimation plan:  One-Stage Cluster 

- **One option!** Use an **unbiased** Horvitz-Thompson estimator to estimate the (overall) **population total**

`$$\hat{t}_{HT} = \sum_{\textrm{sampled units}} w_{ij} y_{ij}$$`


---

## Population Total: One-Stage Cluster 

- **Parameter**: `\(t = \sum_{i=1}^N \sum_{j=1}^{M_i} y_{ij}=  \sum_{i=1}^N t_i\)`


--

- **Unbiased Estimator:** 
`$$\hat{t}_{unb} =  \dfrac{N}{n} \sum_{i=1}^n t_{i} = N\bar{t}$$`
where `\(\bar{t}\)` is the sample mean **total response** per cluster



--


- **Standard error:**
`$$SE(\hat{t}_{unb}) = N \sqrt{\left(1- \dfrac{n}{N} \right) \dfrac{s^{2}_{t}}{n}}$$`
where `\(s_t\)` is the sample standard deviation of cluster totals.

--

- **Confidence interval:** Use a t-distribution with `\(n-1\)` degrees of freedom

---


## Population Mean: One-Stage Cluster 


- **Parameter**: `\(\bar{y}_{\mathcal{U}} = \dfrac{t}{M_0}\)`

- **Assume that `\(M_0\)` is known!**

--

- **Unbiased Estimator:**
`$$\hat{\bar{y}}_{unb} = \dfrac{\hat{t}_{unb} }{M_{0}}$$`

- **Standard error:**
`$$SE(\hat{\bar{y}}_{unb}) = \dfrac{SE(\hat{t}_{unb})}{M_{0}}$$`


---


## Population Proportion: One-Stage Cluster 


- **Parameter**: `\(p = \dfrac{t}{M_0}\)`

- Use formulas for mean where `\(t_{i}\)` counts the number of observation units in cluster `\(i\)` that are a "success"


---

## Example 1 - GPA

`\(N = 100\)`, `\(n = 5\)`, `\(M_i = 4\)`, `\(M_0  = 400\)`


  |  Suite 1  |  Suite 2  |  Suite 3  |  Suite 4  |  Suite 5 
----- | ------ | ------- | ----- | ----- | ---- 
1  |  3.08  |  2.36  |  2.00  |  3.00  |  2.68 
2  |  2.60  |  3.04  |  2.56  |  2.88  |  1.92 
3  |  3.44  |  3.28  |  2.52  |  3.44  |  3.28 
4  |  3.04  |  2.68  |  1.88  |  3.64  |  3.20 
total  |  12.16  |  11.36  |  8.96  |  12.96  |  11.08 

Estimate/SE for the mean GPA in the population.

---


## Population Mean: One-Stage Cluster 


- **Parameter**: `\(\bar{y}_{\mathcal{U}} = \dfrac{t}{M_0}\)`

- **What if `\(M_0\)` is unknown!**

---


## Population Mean: One-Stage Cluster 


- **Parameter**: `\(\bar{y}_{\mathcal{U}} = \dfrac{t}{M_0}\)`

- **Assume that `\(M_0\)` is unknown**

--

- **Biased Ratio Estimator:**
`$$\hat{\bar{y}} _{r} = \dfrac{ \sum_{i=1}^n t_{i} }{ \sum_{i=1}^n M_{i} }$$`

--

- **Standard error:** for large `\(n\)`:

`$$SE(\hat{\bar{y}}_{r}) \approx \sqrt{\left( 1- \dfrac{n}{N}\right) \dfrac{1}{n \bar{M}^{2}} \dfrac{\sum_{i=1}^n (t_{i} - \hat{\bar{y}}_{r} M_{i})^{2}}{n-1}}$$`


---


## Population Total: One-Stage Cluster 


- **Parameter**: `\(t = M_0\bar{y}_{\mathcal{U}}\)`

- **Assume that `\(M_0\)` is known!!**

--

- **Biased Ratio Estimator:**
`$$\hat{t} _{r} = M_0\hat{\bar{y}} _{r}$$`


- **Standard error:** for large `\(n\)`
`$$SE(\hat{t}_{r}) \approx M_0 SE(\hat{\bar{y}}_{r})$$`


---


## One-Stage Cluster estimation options:


- Unbiased vs. Biased:  

  - Biased (ratio) options could be more precise than unbiased options when `\(t_i\)` and `\(M_i\)` are positively correlated
  
- Bias of ratio options:

  - need large `\(n\)` for bias to be small
  
---

## Example 2 - residents

`\(N = 400, n = 5\)` 

 |  Block 1  |  Block 2  |  Block 3  |  Block 4  |  Block 5  |  total  |   `\(s^2_t\)` 
--- | ---- | ---- | ---- | ---- | ---- | ---- | ---- 
# of Adults  |  10  |  15  |  18  |  22  |  17  |  82  |  19.3 
Total Income  |  1100  |  1020  |  972  |  704  |  714  |  4510  |  33144 
# Dems  |  8  |  5  |  7  |  15  |  3  |  38  |  20.8 

Assume that `\(M_0 = 11,482\)`. Estimate/SE the proportion of adults who are Democrats. 

---


## Example 2 - residents

`\(N = 400, n = 5\)` 

 |  Block 1  |  Block 2  |  Block 3  |  Block 4  |  Block 5  |  total  |   `\(s^2_t\)` 
--- | ---- | ---- | ---- | ---- | ---- | ---- | ---- 
# of Adults  |  10  |  15  |  18  |  22  |  17  |  82  |  19.3 
Total Income  |  1100  |  1020  |  972  |  704  |  714  |  4510  |  33144 
# Dems  |  8  |  5  |  7  |  15  |  3  |  38  |  20.8 

Assume you don't know `\(M_0\)`. Estimate/SE the proportion of adults who are Democrats. 


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
